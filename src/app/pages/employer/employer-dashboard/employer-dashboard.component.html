<div class="modern-employer-dashboard">
  <!-- Header Section -->
  <div class="dashboard-header">
    <div class="header-content">
      <div class="title-section">
        <h1>Employer Dashboard</h1>
        <p class="subtitle">Manage your job postings and review applications</p>
      </div>

      <!-- Dashboard Statistics Cards -->
      <div class="stats-cards" *ngIf="!isLoadingStats && employerStats">
        <mat-card class="stat-card">
          <mat-card-content>
            <div class="stat-icon">
              <mat-icon>work</mat-icon>
            </div>
            <div class="stat-info">
              <div class="stat-number">{{ activeJobs.length | number }}</div>
              <div class="stat-label">Total Job Postings</div>
            </div>
          </mat-card-content>
        </mat-card>

        <mat-card class="stat-card">
          <mat-card-content>
            <div class="stat-icon applications">
              <mat-icon>assignment</mat-icon>
            </div>
            <div class="stat-info">
              <div class="stat-number">{{ employerStats.totalApplications | number }}</div>
              <div class="stat-label">Applications Received</div>
            </div>
          </mat-card-content>
        </mat-card>

        <mat-card class="stat-card">
          <mat-card-content>
            <div class="stat-icon active">
              <mat-icon>work_outline</mat-icon>
            </div>
            <div class="stat-info">
              <div class="stat-number">{{ employerStats.activeJobs | number }}</div>
              <div class="stat-label">Active Jobs</div>
            </div>
          </mat-card-content>
        </mat-card>

        <mat-card class="stat-card">
          <mat-card-content>
            <div class="stat-icon hiring">
              <mat-icon>trending_up</mat-icon>
            </div>
            <div class="stat-info">
              <div class="stat-number">{{ employerStats.newApplicationsThisWeek | number }}</div>
              <div class="stat-label">New This Week</div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>

      <!-- Loading Skeleton for Stats -->
      <div class="stats-skeleton" *ngIf="isLoadingStats">
        <div class="skeleton-card" *ngFor="let item of [1,2,3,4]">
          <div class="skeleton-icon"></div>
          <div class="skeleton-info">
            <div class="skeleton-number"></div>
            <div class="skeleton-label"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions Section -->
  <div class="quick-actions-section">
    <div class="container">
      <mat-card class="quick-actions-card">
        <mat-card-content>
          <h2>Quick Actions</h2>
          <div class="action-buttons">
            <button mat-raised-button color="primary" (click)="navigateToPostJob()">
              <mat-icon>add</mat-icon>
              Post New Job
            </button>
            <button mat-raised-button color="accent" (click)="navigateToManageJobs()">
              <mat-icon>work</mat-icon>
              Manage Jobs
            </button>
            <button mat-raised-button (click)="navigateToAnalytics()">
              <mat-icon>analytics</mat-icon>
              View Analytics
            </button>
            <button mat-raised-button (click)="refreshData()">
              <mat-icon>refresh</mat-icon>
              Refresh Data
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>

  <!-- Main Content Tabs -->
  <div class="main-content">
    <div class="container">
      <mat-tab-group class="dashboard-tabs" animationDuration="300ms">

        <!-- Job Management Tab -->
        <mat-tab label="Job Management">
          <ng-template matTabContent>
            <div class="tab-content">
              <!-- Job Search and Filters -->
              <div class="search-filter-section">
                <mat-card class="filter-card">
                  <mat-card-content>
                    <!-- Main Search Bar -->
                    <div class="search-bar">
                      <mat-form-field appearance="outline" class="search-field">
                        <mat-label>Search jobs</mat-label>
                        <input matInput
                               [formControl]="jobSearchControl"
                               placeholder="Search by title, location, or status..."
                               [attr.aria-label]="'Search jobs'">
                        <mat-icon matSuffix>search</mat-icon>
                      </mat-form-field>

                      <button mat-button
                              (click)="showJobFilters = !showJobFilters"
                              [class.active]="showJobFilters"
                              matTooltip="Advanced Filters">
                        <mat-icon>tune</mat-icon>
                        Filters
                      </button>

                      <button mat-button (click)="clearJobFilters()" matTooltip="Clear all filters">
                        <mat-icon>clear</mat-icon>
                        Clear
                      </button>
                    </div>

                    <!-- Filter Presets -->
                    <div class="filter-presets">
                      <span class="presets-label">Quick Filters:</span>
                      <button mat-button
                              *ngFor="let preset of jobFilterPresets"
                              (click)="applyJobFilterPreset(preset)"
                              [color]="preset.color"
                              class="preset-btn">
                        <mat-icon>{{ preset.icon }}</mat-icon>
                        {{ preset.name }}
                      </button>
                    </div>

                    <!-- Advanced Filters Panel -->
                    <div class="advanced-filters" *ngIf="showJobFilters">
                      <mat-expansion-panel expanded>
                        <mat-expansion-panel-header>
                          <mat-panel-title>Advanced Job Filters</mat-panel-title>
                        </mat-expansion-panel-header>

                        <form [formGroup]="jobFiltersForm" class="advanced-filters-form">
                          <div class="filter-row">
                            <mat-form-field appearance="outline">
                              <mat-label>Status</mat-label>
                              <mat-select formControlName="status">
                                <mat-option value="">All Statuses</mat-option>
                                <mat-option value="ACTIVE">Active</mat-option>
                                <mat-option value="CLOSED">Closed</mat-option>
                                <mat-option value="DRAFT">Draft</mat-option>
                              </mat-select>
                            </mat-form-field>

                            <mat-form-field appearance="outline">
                              <mat-label>Job Type</mat-label>
                              <mat-select formControlName="jobType">
                                <mat-option value="">All Types</mat-option>
                                <mat-option value="ONE_DAY">One Day</mat-option>
                                <mat-option value="CONTRACT">Contract</mat-option>
                              </mat-select>
                            </mat-form-field>

                            <mat-form-field appearance="outline">
                              <mat-label>Location</mat-label>
                              <input matInput formControlName="location" placeholder="Filter by location">
                            </mat-form-field>

                            <mat-form-field appearance="outline">
                              <mat-label>Min Salary</mat-label>
                              <input matInput type="number" formControlName="salaryMin" placeholder="0">
                              <span matPrefix>$</span>
                            </mat-form-field>
                          </div>

                          <div class="filter-row">
                            <mat-form-field appearance="outline">
                              <mat-label>Max Salary</mat-label>
                              <input matInput type="number" formControlName="salaryMax" placeholder="200000">
                              <span matPrefix>$</span>
                            </mat-form-field>

                            <mat-form-field appearance="outline">
                              <mat-label>Posted Start Date</mat-label>
                              <input matInput [matDatepicker]="createdStartPicker" formControlName="createdDateStart">
                              <mat-datepicker-toggle matSuffix [for]="createdStartPicker"></mat-datepicker-toggle>
                              <mat-datepicker #createdStartPicker></mat-datepicker>
                            </mat-form-field>

                            <mat-form-field appearance="outline">
                              <mat-label>Posted End Date</mat-label>
                              <input matInput [matDatepicker]="createdEndPicker" formControlName="createdDateEnd">
                              <mat-datepicker-toggle matSuffix [for]="createdEndPicker"></mat-datepicker-toggle>
                              <mat-datepicker #createdEndPicker></mat-datepicker>
                            </mat-form-field>

                            <mat-form-field appearance="outline">
                              <mat-label>Deadline Start Date</mat-label>
                              <input matInput [matDatepicker]="deadlineStartPicker" formControlName="deadlineStart">
                              <mat-datepicker-toggle matSuffix [for]="deadlineStartPicker"></mat-datepicker-toggle>
                              <mat-datepicker #deadlineStartPicker></mat-datepicker>
                            </mat-form-field>
                          </div>
                        </form>
                      </mat-expansion-panel>
                    </div>
                  </mat-card-content>
                </mat-card>
              </div>

              <!-- Bulk Actions Bar for Jobs -->
              <div class="bulk-actions-bar" *ngIf="getSelectedJobsCount() > 0">
                <mat-card class="bulk-actions-card">
                  <mat-card-content>
                    <div class="bulk-actions-content">
                      <div class="selection-info">
                        <mat-icon>check_circle</mat-icon>
                        <span>{{ getSelectedJobsCount() }} job(s) selected</span>
                      </div>

                      <div class="bulk-actions">
                        <button mat-button
                                *ngFor="let action of jobBulkActions"
                                (click)="executeJobBulkAction(action.action)"
                                [color]="action.color"
                                [matTooltip]="action.label">
                          <mat-icon>{{ action.icon }}</mat-icon>
                          {{ action.label }}
                        </button>
                      </div>

                      <button mat-icon-button (click)="jobSelection.clear()" matTooltip="Clear selection">
                        <mat-icon>close</mat-icon>
                      </button>
                    </div>
                  </mat-card-content>
                </mat-card>
              </div>

              <!-- Jobs Table -->
              <div class="table-section">
                <mat-card class="table-card">
                  <mat-card-header class="table-header">
                    <div class="table-title">
                      <mat-card-title>Your Job Postings ({{ activeJobs.length | number }})</mat-card-title>
                      <mat-card-subtitle>Manage your active job listings</mat-card-subtitle>
                    </div>

                    <div class="table-actions">
                      <button mat-icon-button (click)="refreshData()" matTooltip="Refresh Data">
                        <mat-icon>refresh</mat-icon>
                      </button>

                      <button mat-raised-button color="primary" (click)="navigateToPostJob()" matTooltip="Post New Job">
                        <mat-icon>add</mat-icon>
                        Post Job
                      </button>

                      <button mat-button (click)="exportJobs()" matTooltip="Export All Jobs">
                        <mat-icon>download</mat-icon>
                        Export
                      </button>
                    </div>
                  </mat-card-header>

                  <!-- Loading Skeleton -->
                  <div *ngIf="showSkeletons" class="skeleton-container">
                    <div class="skeleton-table">
                      <div class="skeleton-row" *ngFor="let item of [1,2,3,4,5]">
                        <div class="skeleton-cell skeleton-checkbox"></div>
                        <div class="skeleton-cell skeleton-title"></div>
                        <div class="skeleton-cell skeleton-status"></div>
                        <div class="skeleton-cell skeleton-applications"></div>
                        <div class="skeleton-cell skeleton-date"></div>
                        <div class="skeleton-cell skeleton-actions"></div>
                      </div>
                    </div>
                  </div>

                  <!-- Error State -->
                  <div *ngIf="error && !isLoading && !showSkeletons" class="error-state">
                    <mat-icon color="warn" class="error-icon">error_outline</mat-icon>
                    <h3>Unable to load jobs</h3>
                    <p>{{ error }}</p>
                    <button mat-raised-button color="primary" (click)="refreshData()">
                      <mat-icon>refresh</mat-icon>
                      Try Again
                    </button>
                  </div>

                  <!-- Data Table -->
                  <div *ngIf="!showSkeletons && !error" class="table-container">
                    <table mat-table [dataSource]="jobsDataSource" matSort class="modern-table">

                      <!-- Selection Column -->
                      <ng-container matColumnDef="select">
                        <th mat-header-cell *matHeaderCellDef class="select-column">
                          <mat-checkbox
                            [checked]="jobSelection.hasValue() && isAllJobsSelected()"
                            [indeterminate]="jobSelection.hasValue() && !isAllJobsSelected()"
                            (change)="$event ? masterJobToggle() : null"
                            [attr.aria-label]="'Select all jobs'">
                          </mat-checkbox>
                        </th>
                        <td mat-cell *matCellDef="let job" class="select-column">
                          <mat-checkbox
                            [checked]="jobSelection.isSelected(job)"
                            (click)="$event.stopPropagation()"
                            (change)="$event ? jobSelection.toggle(job) : null"
                            [attr.aria-label]="'Select job ' + job.jobTitle">
                          </mat-checkbox>
                        </td>
                      </ng-container>

                      <!-- Job Title Column -->
                      <ng-container matColumnDef="jobTitle">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header class="title-column">Job Title</th>
                        <td mat-cell *matCellDef="let job" class="title-column">
                          <div class="job-title-cell">
                            <div class="primary-text" [matTooltip]="job.jobTitle">
                              {{ truncateText(job.jobTitle, 40) }}
                            </div>
                            <div class="secondary-text">
                              {{ job.location }} • {{ formatSalary(job.salary) }}
                            </div>
<!--                            <div class="priority-indicator"-->
<!--                                 [class]="getJobPriorityLevel(job)"-->
<!--                                 [matTooltip]="'Priority: ' + getJobPriorityLevel(job)">-->
<!--                            </div>-->
                          </div>
                        </td>
                      </ng-container>

                      <!-- Status Column -->
                      <ng-container matColumnDef="status">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header class="status-column">Status</th>
                        <td mat-cell *matCellDef="let job" class="status-column">
                          <mat-chip [color]="getJobStatusColor(job.status)" selected>
                            <mat-icon matChipAvatar>{{ getJobStatusIcon(job.status) }}</mat-icon>
                            {{ job.status }}
                          </mat-chip>
                        </td>
                      </ng-container>

                      <!-- Applications Column -->
                      <ng-container matColumnDef="applicationCount">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header class="applications-column">Applications</th>
                        <td mat-cell *matCellDef="let job" class="applications-column">
                          <div class="metric-cell">
                            <span class="metric-number">{{ job.applicationCount | number }}</span>
                            <mat-progress-bar
                              mode="determinate"
                              [value]="Math.min((job.applicationCount / 50) * 100, 100)"
                              color="primary">
                            </mat-progress-bar>
                          </div>
                        </td>
                      </ng-container>

                      <!-- Posted Date Column -->
                      <ng-container matColumnDef="createdAt">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header class="date-column">Posted Date</th>
                        <td mat-cell *matCellDef="let job" class="date-column">
                          <div class="date-cell">
                            <span class="date-text">{{ formatDateOnly(job.createdAt) }}</span>
                            <span class="time-ago">{{ getTimeAgo(job.createdAt) }}</span>
                          </div>
                        </td>
                      </ng-container>

                      <!-- Application Deadline Column -->
                      <ng-container matColumnDef="expiryDate">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header class="date-column">Application Deadline</th>
                        <td mat-cell *matCellDef="let job" class="date-column">
                          <div class="date-cell">
                            <span class="date-text" [class.expiring]="isJobExpiringSoon(job)">
                              {{ formatDateOnly(job.applicationDeadline) }}
                            </span>
                            <span class="days-left" *ngIf="job.applicationDeadline">
                              {{ getDaysUntilExpiry(job.applicationDeadline) }}d left
                            </span>
                          </div>
                        </td>
                      </ng-container>

                      <!-- Actions Column -->
                      <ng-container matColumnDef="actions">
                        <th mat-header-cell *matHeaderCellDef class="actions-column">Actions</th>
                        <td mat-cell *matCellDef="let job" class="actions-column">
                          <div class="action-buttons">
                            <!-- Quick Actions -->
                            <button mat-icon-button
                                    (click)="viewJobApplications(job)"
                                    matTooltip="View Applications"
                                    color="primary">
                              <mat-icon>assignment</mat-icon>
                            </button>

                            <button mat-icon-button
                                    (click)="editJob(job)"
                                    matTooltip="Edit Job"
                                    color="accent">
                              <mat-icon>edit</mat-icon>
                            </button>

                            <button mat-icon-button
                                    (click)="toggleJobStatus(job)"
                                    [matTooltip]="job.status === 'ACTIVE' ? 'Close Job' : 'Activate Job'"
                                    [color]="job.status === 'ACTIVE' ? 'warn' : 'primary'">
                              <mat-icon>{{ job.status === 'ACTIVE' ? 'pause' : 'play_arrow' }}</mat-icon>
                            </button>

                            <!-- More Actions Menu -->
                            <button mat-icon-button [matMenuTriggerFor]="jobActionsMenu" matTooltip="More Actions">
                              <mat-icon>more_vert</mat-icon>
                            </button>

                            <mat-menu #jobActionsMenu="matMenu">
                              <button mat-menu-item (click)="viewJob(job)">
                                <mat-icon>visibility</mat-icon>
                                <span>View Job Details</span>
                              </button>

                              <button mat-menu-item (click)="featureJob(job)">
                                <mat-icon>star</mat-icon>
                                <span>Feature Job</span>
                              </button>

                              <mat-divider></mat-divider>

                              <button mat-menu-item (click)="deleteJob(job)" class="delete-action">
                                <mat-icon color="warn">delete</mat-icon>
                                <span>Delete Job</span>
                              </button>
                            </mat-menu>
                          </div>
                        </td>
                      </ng-container>

                      <!-- Table Header and Rows -->
                      <tr mat-header-row *matHeaderRowDef="jobsDisplayedColumns; sticky: true"></tr>
                      <tr mat-row
                          *matRowDef="let job; columns: jobsDisplayedColumns;"
                          class="job-row"
                          [class.selected]="jobSelection.isSelected(job)"
                          [class.expiring]="isJobExpiringSoon(job)"
                          (click)="jobSelection.toggle(job)"
                          matRipple>
                      </tr>

                      <!-- No Data Row -->
                      <tr class="mat-row no-data-row" *matNoDataRow>
                        <td class="mat-cell" [attr.colspan]="jobsDisplayedColumns.length">
                          <div class="no-data-message">
                            <mat-icon>work_off</mat-icon>
                            <h3>No jobs found</h3>
                            <p>Try adjusting your search criteria or post your first job</p>
                            <button mat-raised-button color="primary" (click)="navigateToPostJob()">
                              <mat-icon>add</mat-icon>
                              Post New Job
                            </button>
                          </div>
                        </td>
                      </tr>
                    </table>
                  </div>
                </mat-card>
              </div>
            </div>
          </ng-template>
        </mat-tab>

        <!-- Application Management Tab -->
        <mat-tab label="Application Management">
          <ng-template matTabContent>
            <div class="tab-content">
              <!-- Application Search and Filters -->
              <div class="search-filter-section">
                <mat-card class="filter-card">
                  <mat-card-content>
                    <!-- Main Search Bar -->
                    <div class="search-bar">
                      <mat-form-field appearance="outline" class="search-field">
                        <mat-label>Search applications</mat-label>
                        <input matInput
                               [formControl]="applicationSearchControl"
                               placeholder="Search by applicant name, job title, or status..."
                               [attr.aria-label]="'Search applications'">
                        <mat-icon matSuffix>search</mat-icon>
                      </mat-form-field>

                      <button mat-button
                              (click)="showApplicationFilters = !showApplicationFilters"
                              [class.active]="showApplicationFilters"
                              matTooltip="Advanced Filters">
                        <mat-icon>tune</mat-icon>
                        Filters
                      </button>

                      <button mat-button (click)="clearApplicationFilters()" matTooltip="Clear all filters">
                        <mat-icon>clear</mat-icon>
                        Clear
                      </button>
                    </div>

                    <!-- Filter Presets -->
                    <div class="filter-presets">
                      <span class="presets-label">Quick Filters:</span>
                      <button mat-button
                              *ngFor="let preset of applicationFilterPresets"
                              (click)="applyApplicationFilterPreset(preset)"
                              [color]="preset.color"
                              class="preset-btn">
                        <mat-icon>{{ preset.icon }}</mat-icon>
                        {{ preset.name }}
                      </button>
                    </div>

                    <!-- Advanced Filters Panel -->
                    <div class="advanced-filters" *ngIf="showApplicationFilters">
                      <mat-expansion-panel expanded>
                        <mat-expansion-panel-header>
                          <mat-panel-title>Advanced Application Filters</mat-panel-title>
                        </mat-expansion-panel-header>

                        <form [formGroup]="applicationFiltersForm" class="advanced-filters-form">
                          <div class="filter-row">
                            <mat-form-field appearance="outline">
                              <mat-label>Status</mat-label>
                              <mat-select formControlName="status">
                                <mat-option value="">All Statuses</mat-option>
                                <mat-option value="PENDING">Pending</mat-option>
                                <mat-option value="REVIEWED">Reviewed</mat-option>
                                <mat-option value="SHORTLISTED">Shortlisted</mat-option>
                                <mat-option value="INTERVIEWED">Interviewed</mat-option>
                                <mat-option value="REJECTED">Rejected</mat-option>
                                <mat-option value="HIRED">Hired</mat-option>
                              </mat-select>
                            </mat-form-field>

                            <mat-form-field appearance="outline">
                              <mat-label>Job Title</mat-label>
                              <input matInput formControlName="jobTitle" placeholder="Filter by job title">
                            </mat-form-field>

                            <mat-form-field appearance="outline">
                              <mat-label>Applicant Name</mat-label>
                              <input matInput formControlName="workerName" placeholder="Filter by applicant name">
                            </mat-form-field>
                          </div>

                          <div class="filter-row">
                            <mat-form-field appearance="outline">
                              <mat-label>Applied Start Date</mat-label>
                              <input matInput [matDatepicker]="appliedStartPicker" formControlName="appliedDateStart">
                              <mat-datepicker-toggle matSuffix [for]="appliedStartPicker"></mat-datepicker-toggle>
                              <mat-datepicker #appliedStartPicker></mat-datepicker>
                            </mat-form-field>

                            <mat-form-field appearance="outline">
                              <mat-label>Applied End Date</mat-label>
                              <input matInput [matDatepicker]="appliedEndPicker" formControlName="appliedDateEnd">
                              <mat-datepicker-toggle matSuffix [for]="appliedEndPicker"></mat-datepicker-toggle>
                              <mat-datepicker #appliedEndPicker></mat-datepicker>
                            </mat-form-field>
                          </div>
                        </form>
                      </mat-expansion-panel>
                    </div>
                  </mat-card-content>
                </mat-card>
              </div>

              <!-- Bulk Actions Bar for Applications -->
              <div class="bulk-actions-bar" *ngIf="getSelectedApplicationsCount() > 0">
                <mat-card class="bulk-actions-card">
                  <mat-card-content>
                    <div class="bulk-actions-content">
                      <div class="selection-info">
                        <mat-icon>check_circle</mat-icon>
                        <span>{{ getSelectedApplicationsCount() }} application(s) selected</span>
                      </div>

                      <div class="bulk-actions">
                        <button mat-button
                                *ngFor="let action of applicationBulkActions"
                                (click)="executeApplicationBulkAction(action.action)"
                                [color]="action.color"
                                [matTooltip]="action.label">
                          <mat-icon>{{ action.icon }}</mat-icon>
                          {{ action.label }}
                        </button>
                      </div>

                      <button mat-icon-button (click)="applicationSelection.clear()" matTooltip="Clear selection">
                        <mat-icon>close</mat-icon>
                      </button>
                    </div>
                  </mat-card-content>
                </mat-card>
              </div>

              <!-- Applications Table -->
              <div class="table-section">
                <mat-card class="table-card">
                  <mat-card-header class="table-header">
                    <div class="table-title">
                      <mat-card-title>Recent Applications ({{ recentApplications.length | number }})</mat-card-title>
                      <mat-card-subtitle>Review and manage job applications</mat-card-subtitle>
                    </div>

                    <div class="table-actions">
                      <button mat-icon-button (click)="refreshData()" matTooltip="Refresh Data">
                        <mat-icon>refresh</mat-icon>
                      </button>

                      <button mat-button (click)="exportApplications()" matTooltip="Export All Applications">
                        <mat-icon>download</mat-icon>
                        Export
                      </button>
                    </div>
                  </mat-card-header>

                  <!-- Loading Skeleton -->
                  <div *ngIf="showSkeletons" class="skeleton-container">
                    <div class="skeleton-table">
                      <div class="skeleton-row" *ngFor="let item of [1,2,3,4,5]">
                        <div class="skeleton-cell skeleton-checkbox"></div>
                        <div class="skeleton-cell skeleton-applicant"></div>
                        <div class="skeleton-cell skeleton-job"></div>
                        <div class="skeleton-cell skeleton-status"></div>
                        <div class="skeleton-cell skeleton-date"></div>
                        <div class="skeleton-cell skeleton-actions"></div>
                      </div>
                    </div>
                  </div>

                  <!-- Data Table -->
                  <div *ngIf="!showSkeletons && !error" class="table-container">
                    <table mat-table [dataSource]="applicationsDataSource" matSort class="modern-table">

                      <!-- Selection Column -->
                      <ng-container matColumnDef="select">
                        <th mat-header-cell *matHeaderCellDef class="select-column">
                          <mat-checkbox
                            [checked]="applicationSelection.hasValue() && isAllApplicationsSelected()"
                            [indeterminate]="applicationSelection.hasValue() && !isAllApplicationsSelected()"
                            (change)="$event ? masterApplicationToggle() : null"
                            [attr.aria-label]="'Select all applications'">
                          </mat-checkbox>
                        </th>
                        <td mat-cell *matCellDef="let application" class="select-column">
                          <mat-checkbox
                            [checked]="applicationSelection.isSelected(application)"
                            (click)="$event.stopPropagation()"
                            (change)="$event ? applicationSelection.toggle(application) : null"
                            [attr.aria-label]="'Select application ' + application.id">
                          </mat-checkbox>
                        </td>
                      </ng-container>

                      <!-- Applicant Column -->
                      <ng-container matColumnDef="applicant">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header class="applicant-column">Applicant</th>
                        <td mat-cell *matCellDef="let application" class="applicant-column">
                          <div class="applicant-cell">
                            <div class="applicant-avatar">
                              <span class="avatar-initials">{{ getApplicantInitials(application.worker) }}</span>
                            </div>
                            <div class="applicant-info">
                              <div class="primary-text">{{ getApplicantName(application.worker) }}</div>
                              <div class="secondary-text">Worker ID: {{ application.worker?.id }}</div>
                            </div>
                          </div>
                        </td>
                      </ng-container>

                      <!-- Job Title Column -->
                      <ng-container matColumnDef="jobTitle">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header class="job-column">Job Title</th>
                        <td mat-cell *matCellDef="let application" class="job-column">
                          <div class="job-cell">
                            <div class="primary-text" [matTooltip]="application.job?.jobTitle">
                              {{ truncateText(application.job?.jobTitle, 30) }}
                            </div>
                            <div class="secondary-text">{{ application.job?.location }}</div>
                          </div>
                        </td>
                      </ng-container>

                      <!-- Status Column -->
                      <ng-container matColumnDef="status">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header class="status-column">Status</th>
                        <td mat-cell *matCellDef="let application" class="status-column">
                          <mat-chip [color]="getApplicationStatusColor(application.status)" selected>
                            <mat-icon matChipAvatar>{{ getApplicationStatusIcon(application.status) }}</mat-icon>
                            {{ application.status }}
                          </mat-chip>
                        </td>
                      </ng-container>

                      <!-- Applied Date Column -->
                      <ng-container matColumnDef="appliedAt">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header class="date-column">Applied Date</th>
                        <td mat-cell *matCellDef="let application" class="date-column">
                          <div class="date-cell">
                            <span class="date-text">{{ formatDateOnly(application.appliedAt) }}</span>
                            <span class="time-ago">{{ getTimeAgo(application.appliedAt) }}</span>
                          </div>
                        </td>
                      </ng-container>

                      <!-- Actions Column -->
                      <ng-container matColumnDef="actions">
                        <th mat-header-cell *matHeaderCellDef class="actions-column">Actions</th>
                        <td mat-cell *matCellDef="let application" class="actions-column">
                          <div class="action-buttons">
                            <!-- Quick Actions -->
                            <button mat-icon-button
                                    (click)="viewApplication(application)"
                                    matTooltip="View Application"
                                    color="primary">
                              <mat-icon>visibility</mat-icon>
                            </button>

                            <button mat-icon-button
                                    (click)="contactApplicant(application)"
                                    matTooltip="Contact Applicant"
                                    color="accent">
                              <mat-icon>email</mat-icon>
                            </button>

                            <button mat-icon-button
                                    (click)="downloadResume(application)"
                                    matTooltip="Download Resume"
                                    color="primary"
                                    *ngIf="application.resumeUrl">
                              <mat-icon>description</mat-icon>
                            </button>

                            <!-- More Actions Menu -->
                            <button mat-icon-button [matMenuTriggerFor]="applicationActionsMenu" matTooltip="More Actions">
                              <mat-icon>more_vert</mat-icon>
                            </button>

                            <mat-menu #applicationActionsMenu="matMenu">
                              <button mat-menu-item (click)="reviewApplication(application)">
                                <mat-icon>rate_review</mat-icon>
                                <span>Review Application</span>
                              </button>

                              <button mat-menu-item (click)="viewApplicantProfile(application)">
                                <mat-icon>person</mat-icon>
                                <span>View Profile</span>
                              </button>

                              <button mat-menu-item (click)="scheduleInterview(application)">
                                <mat-icon>event</mat-icon>
                                <span>Schedule Interview</span>
                              </button>

                              <mat-divider></mat-divider>

                              <button mat-menu-item (click)="updateApplicationStatus(application, 'SHORTLISTED')">
                                <mat-icon>star</mat-icon>
                                <span>Shortlist</span>
                              </button>

                              <button mat-menu-item (click)="updateApplicationStatus(application, 'REJECTED')">
                                <mat-icon color="warn">cancel</mat-icon>
                                <span>Reject</span>
                              </button>
                            </mat-menu>
                          </div>
                        </td>
                      </ng-container>

                      <!-- Table Header and Rows -->
                      <tr mat-header-row *matHeaderRowDef="applicationsDisplayedColumns; sticky: true"></tr>
                      <tr mat-row
                          *matRowDef="let application; columns: applicationsDisplayedColumns;"
                          class="application-row"
                          [class.selected]="applicationSelection.isSelected(application)"
                          (click)="applicationSelection.toggle(application)"
                          matRipple>
                      </tr>

                      <!-- No Data Row -->
                      <tr class="mat-row no-data-row" *matNoDataRow>
                        <td class="mat-cell" [attr.colspan]="applicationsDisplayedColumns.length">
                          <div class="no-data-message">
                            <mat-icon>assignment_late</mat-icon>
                            <h3>No applications found</h3>
                            <p>Try adjusting your search criteria or wait for new applications</p>
                            <button mat-button color="primary" (click)="clearApplicationFilters()">Clear Filters</button>
                          </div>
                        </td>
                      </tr>
                    </table>
                  </div>
                </mat-card>
              </div>
            </div>
          </ng-template>
        </mat-tab>

        <!-- Analytics Tab -->
        <mat-tab label="Analytics & Insights">
          <ng-template matTabContent>
            <div class="tab-content">
              <div class="analytics-section">
                <div class="analytics-grid">
                  <!-- Job Posting Trends -->
                  <mat-card class="analytics-card">
                    <mat-card-header>
                      <mat-card-title>Job Posting Trends</mat-card-title>
                      <mat-card-subtitle>Monthly job posting activity</mat-card-subtitle>
                    </mat-card-header>
                    <mat-card-content>
                      <div class="chart-placeholder">
                        <mat-icon>trending_up</mat-icon>
                        <p>Chart visualization would go here</p>
                        <div class="trend-data" *ngIf="employerAnalytics">
                          <div *ngFor="let item of employerAnalytics.jobPostingTrends | keyvalue" class="trend-item">
                            <span class="month">{{ item.key }}</span>
                            <span class="value">{{ item.value }}</span>
                          </div>
                        </div>
                      </div>
                    </mat-card-content>
                  </mat-card>

                  <!-- Application Conversion Rates -->
                  <mat-card class="analytics-card">
                    <mat-card-header>
                      <mat-card-title>Application Funnel</mat-card-title>
                      <mat-card-subtitle>Conversion rates through hiring process</mat-card-subtitle>
                    </mat-card-header>
                    <mat-card-content>
                      <div class="chart-placeholder">
                        <mat-icon>filter_list</mat-icon>
                        <p>Funnel chart would go here</p>
                        <div class="funnel-data" *ngIf="employerAnalytics">
                          <div *ngFor="let item of employerAnalytics.hiringFunnelData | keyvalue" class="funnel-item">
                            <span class="stage">{{ item.key }}</span>
                            <span class="count">{{ item.value }}</span>
                          </div>
                        </div>
                      </div>
                    </mat-card-content>
                  </mat-card>

                  <!-- Time to Hire Metrics -->
                  <mat-card class="analytics-card">
                    <mat-card-header>
                      <mat-card-title>Time to Hire</mat-card-title>
                      <mat-card-subtitle>Average hiring timeline metrics</mat-card-subtitle>
                    </mat-card-header>
                    <mat-card-content>
                      <div class="metrics-grid" *ngIf="employerAnalytics">
                        <div class="metric-item">
                          <div class="metric-value">{{ employerAnalytics.timeToHireMetrics['Average'] }}d</div>
                          <div class="metric-label">Average</div>
                        </div>
                        <div class="metric-item">
                          <div class="metric-value">{{ employerAnalytics.timeToHireMetrics['Fastest'] }}d</div>
                          <div class="metric-label">Fastest</div>
                        </div>
                        <div class="metric-item">
                          <div class="metric-value">{{ employerAnalytics.timeToHireMetrics['Slowest'] }}d</div>
                          <div class="metric-label">Slowest</div>
                        </div>
                      </div>
                    </mat-card-content>
                  </mat-card>

                  <!-- Recruitment Effectiveness -->
                  <mat-card class="analytics-card">
                    <mat-card-header>
                      <mat-card-title>Recruitment Sources</mat-card-title>
                      <mat-card-subtitle>Application sources effectiveness</mat-card-subtitle>
                    </mat-card-header>
                    <mat-card-content>
                      <div class="chart-placeholder">
                        <mat-icon>pie_chart</mat-icon>
                        <p>Pie chart would go here</p>
                        <div class="source-data" *ngIf="employerAnalytics">
                          <div *ngFor="let item of employerAnalytics.recruitmentEffectiveness | keyvalue" class="source-item">
                            <span class="source">{{ item.key }}</span>
                            <span class="percentage">{{ item.value }}%</span>
                          </div>
                        </div>
                      </div>
                    </mat-card-content>
                  </mat-card>
                </div>
              </div>
            </div>
          </ng-template>
        </mat-tab>

      </mat-tab-group>
    </div>
  </div>
</div>
