<div class="dashboard-container">
  <!-- Dashboard Header -->
  <section class="dashboard-header">
    <div class="container">
      <div class="header-content animate-fade-in-up">
        <div class="welcome-section">
          <h1 class="welcome-title">
            Welcome back!
            <span class="wave">ðŸ‘‹</span>
          </h1>
          <p class="welcome-subtitle" *ngIf="userRole === 'WORKER'">
            Ready to find your next opportunity?
          </p>
          <p class="welcome-subtitle" *ngIf="userRole === 'EMPLOYER'">
            Manage your jobs and find the perfect candidates
          </p>
        </div>

        <div class="quick-stats" *ngIf="userRole === 'WORKER' && workerStats">
          <div class="stat-card glass">
            <div class="stat-icon">
              <mat-icon>work</mat-icon>
            </div>
            <div class="stat-info">
              <span class="stat-number">{{ workerStats.totalApplications }}</span>
              <span class="stat-label">Applications</span>
            </div>
          </div>

          <div class="stat-card glass">
            <div class="stat-icon">
              <mat-icon>visibility</mat-icon>
            </div>
            <div class="stat-info">
              <span class="stat-number">{{ workerStats.profileViews }}</span>
              <span class="stat-label">Profile Views</span>
            </div>
          </div>

          <div class="stat-card glass">
            <div class="stat-icon">
              <mat-icon>star</mat-icon>
            </div>
            <div class="stat-info">
              <span class="stat-number">{{ workerStats.interviewsScheduled }}</span>
              <span class="stat-label">Interviews</span>
            </div>
          </div>
        </div>

        <!-- Loading state for worker stats -->
        <div class="quick-stats" *ngIf="userRole === 'WORKER' && !workerStats && isLoading">
          <div class="stat-card glass">
            <mat-spinner diameter="30"></mat-spinner>
          </div>
        </div>

        <div class="quick-stats" *ngIf="userRole === 'EMPLOYER' && employerStats">
          <div class="stat-card glass">
            <div class="stat-icon">
              <mat-icon>business</mat-icon>
            </div>
            <div class="stat-info">
              <span class="stat-number">{{ employerStats.activeJobs }}</span>
              <span class="stat-label">Active Jobs</span>
            </div>
          </div>

          <div class="stat-card glass">
            <div class="stat-icon">
              <mat-icon>people</mat-icon>
            </div>
            <div class="stat-info">
              <span class="stat-number">{{ employerStats.totalApplications }}</span>
              <span class="stat-label">Applications</span>
            </div>
          </div>

          <div class="stat-card glass">
            <div class="stat-icon">
              <mat-icon>trending_up</mat-icon>
            </div>
            <div class="stat-info">
              <span class="stat-number">{{ employerStats.newApplicationsThisWeek }}</span>
              <span class="stat-label">New This Week</span>
            </div>
          </div>
        </div>

        <!-- Loading state for employer stats -->
        <div class="quick-stats" *ngIf="userRole === 'EMPLOYER' && !employerStats && isLoading">
          <div class="stat-card glass">
            <mat-spinner diameter="30"></mat-spinner>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Worker Dashboard -->
  <section *ngIf="userRole === 'WORKER'" class="worker-dashboard section">
    <div class="container">
      <div class="dashboard-grid">
        <!-- Recommended Jobs -->
        <div class="dashboard-card modern-card">
          <div class="card-header">
            <h2 class="card-title">
              <mat-icon>recommend</mat-icon>
              Recommended for You
            </h2>
            <button mat-button class="view-all-btn" routerLink="/app/jobs">
              View All
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </div>

          <div class="card-content">
            <div *ngIf="recommendedJobs.length > 0; else noRecs" class="recommendations-list">
              <div class="job-recommendation" *ngFor="let job of recommendedJobs.slice(0, 3)">
                <div class="job-info">
                  <div class="company-avatar">
                    {{ job.employerCompanyName.charAt(0) || 'C' }}
                  </div>
                  <div class="job-details">
                    <h4 class="job-title">{{ job.jobTitle }}</h4>
<!--                    <p class="company-name">{{ job.employerCompanyName || 'Company' }}</p>-->
<!--                    <div class="job-meta">-->
                      <span class="location">
                        <mat-icon>location_on</mat-icon>
                        {{ job.location }}
                      </span>
<!--                      <span class="salary" *ngIf="job.salary">-->
<!--                        {{ formatSalary(job.salary, job.currency) }}-->
<!--                      </span>-->
<!--                      <span class="job-type">{{ job.jobType.replace('_', ' ') }}</span>-->
<!--                    </div>-->
                  </div>
                </div>
                <div class="job-actions">
                  <button mat-stroked-button [routerLink]="['/app/jobs', job.id]" class="view-btn">
                    View
                  </button>
                  <button mat-raised-button color="primary" class="apply-btn" (click)="onJobClick(job.id)">
                    Apply
                  </button>
                </div>
              </div>
            </div>

            <ng-template #noRecs>
              <div class="empty-state">
                <mat-icon class="empty-icon">work_off</mat-icon>
                <h4>No recommendations yet</h4>
                <p>Complete your profile to get personalized job recommendations</p>
                <button mat-raised-button color="primary" routerLink="/app/profile" class="btn-modern">
                  Update Profile
                </button>
              </div>
            </ng-template>

            <!-- Loading state -->
            <div *ngIf="isLoading" class="loading-state">
              <mat-spinner diameter="40"></mat-spinner>
              <p>Finding perfect matches for you...</p>
            </div>
          </div>
        </div>

        <!-- Recent Applications -->
        <div class="dashboard-card modern-card">
          <div class="card-header">
            <h2 class="card-title">
              <mat-icon>assignment</mat-icon>
              Recent Applications
            </h2>
            <button mat-button class="view-all-btn" routerLink="/app/my-applications">
              View All
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </div>

          <div class="card-content">
            <div *ngIf="recentApplications.length > 0; else noApplications" class="applications-list">
              <div class="application-item" *ngFor="let app of recentApplications.slice(0, 3)">
                <div class="application-info">
                  <h4 class="job-title">{{ app.job?.jobTitle || 'Job Title' }}</h4>
                  <p class="company-name">{{ app.job?.employerProfile?.companyName || 'Company' }}</p>
                  <span class="application-date">Applied {{ formatDate(app.appliedAt) }}</span>
                </div>
                <div class="application-status">
                  <span class="status-badge"
                        [ngClass]="'badge-' + getApplicationStatusColor(app.status)">
                    {{ app.status.replace('_', ' ') }}
                  </span>
                </div>
              </div>
            </div>

            <ng-template #noApplications>
              <div class="empty-state">
                <mat-icon class="empty-icon">assignment_late</mat-icon>
                <h4>No applications yet</h4>
                <p>Start applying to jobs to see your application history here</p>
                <button mat-raised-button color="primary" routerLink="/app/jobs" class="btn-modern">
                  Browse Jobs
                </button>
              </div>
            </ng-template>

            <!-- Loading state -->
            <div *ngIf="isLoading" class="loading-state">
              <mat-spinner diameter="30"></mat-spinner>
              <p>Loading applications...</p>
            </div>
          </div>
        </div>

        <!-- Profile Completion -->
        <div class="dashboard-card modern-card profile-completion">
          <div class="card-header">
            <h2 class="card-title">
              <mat-icon>person</mat-icon>
              Profile Strength
            </h2>
          </div>

          <div class="card-content">
            <div *ngIf="profileCompletion; else loadingProfile" class="progress-section">
              <div class="progress-info">
                <span class="progress-label">Profile Completion</span>
                <span class="progress-percentage">{{ profileCompletion.percentage }}%</span>
              </div>
              <mat-progress-bar
                mode="determinate"
                [value]="profileCompletion.percentage"
                [color]="getProfileCompletionColor()">
              </mat-progress-bar>
            </div>

            <div *ngIf="profileCompletion && profileCompletion.tips && profileCompletion.tips.length > 0" class="improvement-tips">
              <h4>Boost your profile:</h4>
              <ul class="tips-list">
                <li *ngFor="let tip of profileCompletion.tips.slice(0, 3)">
                  <mat-icon>add_circle_outline</mat-icon>
                  {{ tip }}
                </li>
              </ul>
              <button mat-raised-button color="primary" routerLink="/app/profile" class="btn-modern">
                Complete Profile
              </button>
            </div>

            <ng-template #loadingProfile>
              <div class="loading-state">
                <mat-spinner diameter="30"></mat-spinner>
                <p>Loading profile data...</p>
              </div>
            </ng-template>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="dashboard-card modern-card quick-actions">
          <div class="card-header">
            <h2 class="card-title">
              <mat-icon>flash_on</mat-icon>
              Quick Actions
            </h2>
          </div>

          <div class="card-content">
            <div class="actions-grid">
              <button mat-raised-button class="action-btn" routerLink="/app/jobs">
                <mat-icon>search</mat-icon>
                Browse Jobs
              </button>
              <button mat-raised-button class="action-btn" routerLink="/app/profile">
                <mat-icon>edit</mat-icon>
                Edit Profile
              </button>
              <button mat-raised-button class="action-btn" routerLink="/app/my-applications">
                <mat-icon>assignment</mat-icon>
                My Applications
              </button>
              <button mat-raised-button class="action-btn">
                <mat-icon>help</mat-icon>
                Get Help
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Employer Dashboard -->
  <section *ngIf="userRole === 'EMPLOYER'" class="employer-dashboard section">
    <div class="container">
      <div class="dashboard-grid">
        <!-- Active Jobs -->
        <div class="dashboard-card modern-card">
          <div class="card-header">
            <h2 class="card-title">
              <mat-icon>business</mat-icon>
              Active Job Postings
            </h2>
            <button mat-button class="view-all-btn" routerLink="/app/employer/jobs">
              Manage All
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </div>

          <div class="card-content">
            <div class="jobs-list" *ngIf="activeJobs.length > 0; else noActiveJobs">
              <div class="job-item" *ngFor="let job of activeJobs; trackBy: trackByJobId" (click)="onJobClick(job.id)">
                <div class="job-info">
                  <h4 class="job-title">{{ job.jobTitle }}</h4>
                  <div class="job-meta">
                    <span class="applications-count">
                      <mat-icon>people</mat-icon>
                      {{ job.applicationCount || 0 }} applications
                    </span>
                    <span class="posted-date">Posted {{ getDaysAgo(job.createdAt) }}</span>
                  </div>
                  <div class="job-details">
                    <span class="job-location">
                      <mat-icon>location_on</mat-icon>
                      {{ job.location }}
                    </span>
                    <span class="job-salary" *ngIf="job.salary">
                      <mat-icon>attach_money</mat-icon>
                      ${{ job.salary | number }}
                    </span>
                  </div>
                </div>
                <div class="job-actions">
                  <button mat-stroked-button class="view-btn" (click)="onViewApplications(job.id); $event.stopPropagation()">
                    View Applications
                  </button>
                  <button mat-icon-button [matMenuTriggerFor]="jobMenu" (click)="$event.stopPropagation()">
                    <mat-icon>more_vert</mat-icon>
                  </button>
                  <mat-menu #jobMenu="matMenu">
                    <button mat-menu-item (click)="onEditJob(job.id)">
                      <mat-icon>edit</mat-icon>
                      Edit Job
                    </button>
                    <button mat-menu-item (click)="onViewJob(job.id)">
                      <mat-icon>visibility</mat-icon>
                      View Details
                    </button>
                  </mat-menu>
                </div>
              </div>
            </div>

            <ng-template #noActiveJobs>
              <div class="empty-state">
                <mat-icon>work_off</mat-icon>
                <h3>No Active Jobs</h3>
                <p>You don't have any active job postings at the moment.</p>
                <button mat-raised-button color="primary" (click)="onPostNewJob()">
                  Post Your First Job
                </button>
              </div>
            </ng-template>
          </div>
        </div>

        <!-- Recent Applications -->
        <div class="dashboard-card modern-card">
          <div class="card-header">
            <h2 class="card-title">
              <mat-icon>inbox</mat-icon>
              Recent Applications
            </h2>
            <button mat-button class="view-all-btn">
              View All
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </div>

          <div class="card-content">
            <div class="applications-list" *ngIf="recentEmployerApplications.length > 0; else noRecentApplications">
              <div class="application-item" *ngFor="let app of recentEmployerApplications; trackBy: trackByApplicationId" (click)="onApplicationClick(app.id)">
                <div class="applicant-info">
                  <div class="applicant-avatar">
                    {{ getApplicantInitials(app.worker) }}
                  </div>
                  <div class="applicant-details">
                    <h4 class="applicant-name">{{ getApplicantName(app.worker) }}</h4>
                    <p class="applied-position">Applied for {{ app.job?.jobTitle || 'Unknown Position' }}</p>
                    <span class="application-time">{{ getTimeAgo(app.appliedAt) }}</span>
                    <div class="application-status">
                      <span class="status-badge" [class]="'status-' + app.status.toLowerCase()">
                        {{ formatApplicationStatus(app.status) }}
                      </span>
                    </div>
                  </div>
                </div>
                <div class="application-actions">
                  <button mat-stroked-button class="review-btn" (click)="onReviewApplication(app.id); $event.stopPropagation()">
                    Review
                  </button>
                  <button mat-icon-button [matMenuTriggerFor]="appMenu" (click)="$event.stopPropagation()">
                    <mat-icon>more_vert</mat-icon>
                  </button>
                  <mat-menu #appMenu="matMenu">
                    <button mat-menu-item (click)="onViewApplicantProfile(app.workerId)">
                      <mat-icon>person</mat-icon>
                      View Profile
                    </button>
                    <button mat-menu-item (click)="onUpdateApplicationStatus(app.id)">
                      <mat-icon>update</mat-icon>
                      Update Status
                    </button>
                  </mat-menu>
                </div>
              </div>
            </div>

            <ng-template #noRecentApplications>
              <div class="empty-state">
                <mat-icon>inbox</mat-icon>
                <h3>No Recent Applications</h3>
                <p>No new applications have been received recently.</p>
                <button mat-stroked-button (click)="onViewAllApplications()">
                  View All Applications
                </button>
              </div>
            </ng-template>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="dashboard-card modern-card employer-actions">
          <div class="card-header">
            <h2 class="card-title">
              <mat-icon>flash_on</mat-icon>
              Quick Actions
            </h2>
          </div>

          <div class="card-content">
            <div class="actions-grid">
              <button mat-raised-button color="primary" routerLink="/app/jobs/new" class="action-btn primary">
                <mat-icon>add</mat-icon>
                Post New Job
              </button>
              <button mat-raised-button class="action-btn" routerLink="/app/employer/jobs">
                <mat-icon>business</mat-icon>
                Manage Jobs
              </button>
              <button mat-raised-button class="action-btn">
                <mat-icon>analytics</mat-icon>
                View Analytics
              </button>
              <button mat-raised-button class="action-btn" routerLink="/app/profile">
                <mat-icon>edit</mat-icon>
                Company Profile
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
